{% extends 'login_base.html' %}
{% block title %}레몬::정보변경{% endblock title %}
{% block container %}
<style>
  #footer {
    display: none;
  }

  .loader-main{
    bottom:0px !important;
  }

  .footer-line-myinfo{
    /* 하단바 선택시 밑줄 */
    width: 50px;
    padding: 7px 0 5px 0;
    border-bottom: 2px solid #fff;
  }

  .pin-change input {
  border: none;
  text-align: center;
  width: 48px;
  height:48px;
  font-size: 20px;
  background-color: #F3F3F3;
  margin-right:5px;
  padding-bottom: 10px;
  }

.pin-change input:focus {
  border: 1px solid #573D8B;
  outline:none;
}


input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

</style>

{% block nav %}
<!-- 상단바 영역 시작 -->
<div id="nav" style="border-bottom: 1px solid #f1f1f1;">
  <div>
    <div style="text-align:center;">
      <a style="color: #fff;" href="{% url 'accounts:myinfo' %}">
        <i class="fa fa-angle-left"></i>
      </a>Pin 번호 변경
    </div>
  </div>
</div>
<!-- 상단바 영역 끝 -->
{% endblock nav %}

  <form action="" method="POST" id="pin_saver">
    {% csrf_token %}
    <div class="pin-wrap" style="padding-top:200px;">
            <div class="pin-change">
            <input type="number" id="pin_5" maxlength="1" autofocus>
            <input type="number" id="pin_6" maxlength="1">
            <input type="number" id="pin_7" maxlength="1">
          <input type="number"  id="pin_8" maxlength="1">
       </div>
    </div>
      <input type="hidden" id="pin_change" name="pin">
    <div class="pin-btn-wrap">
      <button class="pin-btn" type="button" onclick="check()">Pin 번호 변경</button>
    </div>
  </form>

  <script>
  function check(){
    var pin = $('#pin_5').val() + $('#pin_6').val() + $('#pin_7').val() + $('#pin_8').val();
    if ( pin == ''){
      alert('핀번호를 입력 부탁드립니다.');
      return false;
    }
    if (!pin.match(/^[0-9]{4}$/)) {
       alert('Pin 번호 4자리를 입력해주세요.');
       return false;
    }
    else{
    $('#pin_change').val(pin);
    alert('핀번호가 변경되었습니다.');
    const form = document.getElementById('pin_saver');
    form.submit();
    }
  }
var pinContainer = document.querySelector(".pin-change");
pinContainer.addEventListener('keyup', function (event) {
    var target = event.srcElement;

    var maxLength = parseInt(target.attributes["maxlength"].value, 10);
    var myLength = target.value.length;

    if (myLength >= maxLength) {
        var next = target;
        while (next = next.nextElementSibling) {
            if (next == null) break;
            if (next.tagName.toLowerCase() == "input") {
                next.focus();
                break;
            }
        }
    }

    if (myLength === 0) {
        var next = target;
        while (next = next.previousElementSibling) {
            if (next == null) break;
            if (next.tagName.toLowerCase() == "input") {
                next.focus();
                break;
            }
        }
    }
}, false);

pinContainer.addEventListener('keydown', function (event) {
    var target = event.srcElement;
    target.value = "";
}, false);
</script>
{% endblock %}